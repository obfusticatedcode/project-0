"use strict";$(function(){function e(){var e=$(event.target).position();return f=a(e.top,e.left)}function t(e,t){return{top:t*(r+c)+"px",left:e*(r+c)+"px"}}function a(e,t){return{x:t/(r+c),y:e/(r+c)}}function o(){var e=$("div.square"),t=$("div.piece").map(function(t,o){var n=$(o).position(),s=a(n.top,n.left),i=8*s.y+s.x;return e[i]});return $("div.square.dark").not(t)}function n(e,t,a){e.css("top",t),e.css("left",a)}function s(e){e.hasClass("selected")?e.removeClass("selected"):($("div.piece").each(function(e,t){$(t).hasClass("selected")&&$(t).removeClass("selected")}),e.addClass("selected"))}function i(){$("#moveCounter").html(parseInt($("#moveCounter").html(),10)+1)}function l(){location.reload()}for(var r=46,c=2,d=$("div#board"),v=$("div#pieces"),u=$("#reset-button"),f=null,p=0;p<64;p++)d.append($("<div/>").addClass("square"));!function(){function e(e){return e%8%2^Math.floor(e/8)%2}$("div.square").each(function(t){0===e(t)?$(this).addClass("light"):$(this).addClass("dark")})}();for(var h=0;h<24;h++)v.append($("<div/>").addClass("piece"));!function(){$("piece"),$("div.piece:even").addClass("light"),$("div.piece:odd").addClass("dark")}(),$("div.piece.light").each(function(e,a){var o=Math.floor(e/4),s=e%4*2+(1-o%2),i=t(s,o);n($(a),i.top,i.left)}),$("div.piece.dark").each(function(e,a){var o=Math.floor(e/4)+5,s=e%4*2+(1-o%2),i=t(s,o);n($(a),i.top,i.left)}),o().addClass("movable"),u.on("click",function(){l()}),$("div.piece").on("click",function(t){var a=$(t.target);e();var o=f;console.log(o);var n=o+r+1;console.log(n);var i=a.hasClass("dark");console.log(i),s(a)}),$("div.square").on("click",function(a){e();var s=$(a.target);if(s.hasClass("movable")){var l=$("div.piece.selected");if(1===l.length){var r=s.prevAll().length,c=r%8,d=Math.floor(r/8),v=t(c,d);n(l,v.top,v.left),i(),l.removeClass("selected"),$("div.square").removeClass("movable"),o().addClass("movable")}}})});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC5qcyJdLCJuYW1lcyI6WyIkIiwiY3VycmVudFBvc2l0aW9uIiwicG9zaXRpb24iLCJldmVudCIsInRhcmdldCIsImNvb3JkcyIsImdldENvb3JkcyIsInRvcCIsImxlZnQiLCJnZXRQaXhlbHMiLCJ4IiwieSIsIndpZHRoIiwiYm9yZGVyIiwiJHRha2VuU3F1YXJlcyIsImdldE1vdmFibGVTcXVhcmVzIiwiJHNxdWFyZXMiLCJtYXAiLCJpbmRleCIsInBpZWNlIiwiYWRkQ2xhc3MiLCJzcXVhcmVJbmRleCIsIm1vdmVQaWVjZVRvIiwibm90IiwibmV3TGVmdCIsIm5ld1RvcCIsIiRwaWVjZSIsImNzcyIsInRvZ2dsZVNlbGVjdCIsImhhc0NsYXNzIiwicmVzZXQiLCJlYWNoIiwicmVtb3ZlQ2xhc3MiLCJpbmNyZW1lbnRtb3ZlQ291bnRlciIsImh0bWwiLCJwYXJzZUludCIsImxvY2F0aW9uIiwicmVsb2FkIiwic3F1YXJlQ291bnQiLCIkYm9hcmQiLCIkcGllY2VzIiwiaSIsImFwcGVuZCIsImZsb29yIiwibGlnaHRPckRhcmsiLCJ0aGlzIiwiTWF0aCIsInBpeGVsUG9zaXRpb24iLCIkcmVzZXRCdXR0b24iLCJvbiIsImNvbnNvbGUiLCJmaXJzdENvbHVtbiIsImRhcmtQaWVjZSIsImxvZyIsIiR0aGlzUGllY2UiLCJlIiwiJHNlbGVjdGVkUGllY2UiLCJsZW5ndGgiLCIkcGllY2VUb01vdmUiLCJwcmV2QWxsIiwicGl4ZWxzIl0sIm1hcHBpbmdzIjoiWUFDQUEsR0FBRSxXQWdJRUMsUUFBQUEsS0FDQSxHQUFBQyxHQUFBRixFQUFBRyxNQUFBQyxRQUFBRixVQU5BLE9BT0FHLEdBQUFDLEVBQUFKLEVBQUFLLElBQUFMLEVBQUFNLE1BdURFLFFBQUFDLEdBQUFDLEVBQUFDLEdBR0EsT0FDQUosSUFBS0EsR0FBT0ssRUFBQUEsR0FBUCxLQUZQSixLQUFBRSxHQUFBRSxFQUFBQyxHQUFBLE1BVUUsUUFBQVAsR0FBQUMsRUFBQUMsR0FHSixPQUNBRSxF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QUFNLEdBQ0p0RCxHQUdBLElBQUl1RCxHQUFlQyxFQUFBQSxFQUFBQSxPQUlqQixJQUFBQyxFQUFVeEMsU0FBVixXQUFBLENBR0ksR0FBQXNDLEdBQUF4RCxFQUFBLHFCQUdKaUMsSUFBQUEsSUFBQUEsRUFBQUEsT0FBQUEsQ0FQQSxHQUFNZixHQUFRd0MsRUFBYUMsVUFBVUYsT0FXakMvQyxFQUFBUSxFQUFBLEVBQ0ZQLEVBQUFtQyxLQUFGSCxNQUFnQlgsRUFBWSxHQUM1QmpCLEVBQUFBLEVBQW9CSyxFQUFBQSxFQUd2QkUsR0FBQWtDLEVBQUFJLEVBQUFyRCxJQUFBcUQsRUFBQXBELE1BVEd5QixJQUVBdUIsRUFBZXhCLFlBQVksWUFnQmpDaEMsRUFBQSxjQUFBZ0MsWUFBQSxXQUNBakIsSUFBQUssU0FBQSIsImZpbGUiOiJhcHAuanMiLCJzb3VyY2VzQ29udGVudCI6WyIvL2xvYWRpbmcgSlNcbiQoKCk9PntcblxuICAvL0dMT0JBTCBWQVJJQUJMRVNcbiAgY29uc3Qgd2lkdGggPSA0NjtcbiAgY29uc3QgYm9yZGVyID0gMjtcbiAgY29uc3QgJGJvYXJkID0gJCgnZGl2I2JvYXJkJyk7XG4gIGNvbnN0ICRwaWVjZXMgPSAkKCdkaXYjcGllY2VzJyk7XG4gIGNvbnN0ICRyZXNldEJ1dHRvbiA9ICQoJyNyZXNldC1idXR0b24nKTtcbiAgbGV0IGNvb3JkcyA9IG51bGw7Ly9zZXR0aW5nIGNvb3JkcyBnbG9iYWxseSBzbyBjb25zdGFudGx5IHVwZGF0aW5nXG5cblxuXG4gIC8vQ3JlYXRpbmcgdGhlIDY0IHNxdWFyZXMgYW5kIGFkZGluZyB0aGVtIHRvIHRoZSBET01cbiAgY29uc3Qgc3F1YXJlQ291bnQgPSA4Kjg7IC8vOCByb3dzIGJ5IDggY29sdW1uczsgemVybyBiYXNlZCBpbmRleFxuICBmb3IgKGxldCBpID0gMDtpPHNxdWFyZUNvdW50O2krKykge1xuXG4gIC8vdGhpcyBsaW5lIGNyZWF0ZXMgYSBuZXcgZGl2IHdpdGggdGhlIGNsYXNzICdzcXVhcmUnXG4gIC8vYW5kIGFwcGVuZHMgaXQgdG8gdGhlIGRpdiB3aXRoIGlkICdib2FyZCdcbiAgICAkYm9hcmQuYXBwZW5kKCQoJzxkaXYvPicpLmFkZENsYXNzKCdzcXVhcmUnKSk7XG4gIH1cblxuXG4gIC8vc2V0IHVwIHRoZSBib2FyZCB3aXRoIHRoZSBjb3JyZWN0IGNsYXNzZXMgZm9yIHRoZSBsaWdodCBhbmQgZGFyayBzcXVhcmVzXG4gIHNldFVwQm9hcmQoKTtcblxuXG4gICAgICAvL2NyZWF0aW5nIHRoZSAyNCBwaWVjZXMgYW5kIGFkZGluZyB0aGVtIHRvIHRoZSBET01cbiAgY29uc3QgcGllY2VDb3VudCA9IDI0O1xuICBmb3IgKGxldCBpPTA7aTxwaWVjZUNvdW50O2krKykge1xuXG4gICAgLy90aGlzIGxpbmUgYXBwZW5kcyBhbiBlbXB0eSBkaXYgd2l0aCB0aGUgY2xhc3MgJ3BpZWNlJyB0byB0aGUgZGl2IHdpdGggaWQgJ3BpZWNlcydcbiAgICAkcGllY2VzLmFwcGVuZCgkKCc8ZGl2Lz4nKS5hZGRDbGFzcygncGllY2UnKSk7XG5cbiAgfVxuXG5cbiAgLy9zZXRzIHVwIHRoZSBjbGFzc2VzIGZvciB0aGUgZGlmZmVyZW50IHR5cGVzIG9mIHBpZWNlXG4gIHNldFVwUGllY2VzKCk7XG5cbiAgLy90aGlzIGxvb3AgbW92ZXMgYWxsIHRoZSBsaWdodCBwaWVjZXMgdG8gdGhlaXIgaW5pdGlhbCBwb3NpdGlvbnNcbiAgJCgnZGl2LnBpZWNlLmxpZ2h0JykuZWFjaChmdW5jdGlvbihpbmRleCxwaWVjZSkge1xuXG4gICAgLy90dXJuaW5nIHRoZSBpbmRleCAoZnJvbSAwIC0gMTEpXG4gICAgLy9pbnRvIGEgeCx5IHNxdWFyZSBjb29yZGluYXRlIHVzaW5nIG1hdGhcbiAgICBjb25zdCB5ID0gTWF0aC5mbG9vcihpbmRleCAvIDQpO1xuICAgIGNvbnN0IHggPSAoaW5kZXggJSA0KSAqIDIgKyAoMSAtIHklMik7XG5cbiAgICAvL3R1cm5pbmcgdGhlIHgseSBjb29yZGluZ2F0ZSBpbnRvIGEgcGl4ZWwgcG9zaXRpb25cbiAgICBjb25zdCBwaXhlbFBvc2l0aW9uID0gZ2V0UGl4ZWxzKHgseSk7XG4gICAgLy9hY3R1YWxseSBtb3ZpbmcgdGhlIHBpZWNlIHRvIGl0cyBpbml0aWFsIHBvc2l0aW9uXG4gICAgbW92ZVBpZWNlVG8oJChwaWVjZSkscGl4ZWxQb3NpdGlvbi50b3AscGl4ZWxQb3NpdGlvbi5sZWZ0KTtcbiAgfSk7XG5cbiAgICAvL3RoaXMgbG9vcCBtb3ZlcyBhbGwgdGhlIGRhcmsgcGllY2VzIHRvIHRoZWlyIGluaXRpYWwgcG9zaXRpb25zXG4gICQoJ2Rpdi5waWVjZS5kYXJrJykuZWFjaChmdW5jdGlvbihpbmRleCxwaWVjZSkge1xuICAgIC8vdHVybmluZyB0aGUgaW5kZXggKGZyb20gMCAtIDExKVxuICAgIC8vaW50byBhIHgseSBzcXVhcmUgY29vcmRpbmF0ZSB1c2luZyBtYXRoXG4gICAgY29uc3QgeSA9IE1hdGguZmxvb3IoaW5kZXgvNCkgKyA1O1xuICAgIGNvbnN0IHggPSAoaW5kZXggJSA0KSAqIDIgKyAoMS15JTIpO1xuXG4gICAgLy90dXJuaW5nIHRoZSB4LHkgY29vcmRpbmF0ZSBpbnRvIGEgcGl4ZWwgcG9zaXRpb25cbiAgICBjb25zdCBwaXhlbFBvc2l0aW9uID0gZ2V0UGl4ZWxzKHgseSk7XG4gICAgLy9tb3ZpbmcgdGhlIHBpZWNlIHRvIGl0cyBpbml0aWFsIHBvc2l0aW9uXG4gICAgbW92ZVBpZWNlVG8oJChwaWVjZSkscGl4ZWxQb3NpdGlvbi50b3AscGl4ZWxQb3NpdGlvbi5sZWZ0KTtcbiAgfSk7XG5cbiAgICAvL3NldCB1cCBpbml0aWFsIHNxdWFyZXMgdGhlIGNsYXNzICdtb3ZhYmxlJyByZXByZXNlbnRzIGEgc3F1YXJlXG4gICAgLy90aGF0IGlzIHVub2NjdXBpZWQgYW5kIHRoaXMgYWxsb3dzIGFsbCBzcXVhcmVzIGRhcmsgc3F1YXJlcyB0byBiZSBtb3ZhYmxlXG4gIGdldE1vdmFibGVTcXVhcmVzKCkuYWRkQ2xhc3MoJ21vdmFibGUnKTtcblxuICAgICAgLy9FVkVOVFNcblxuICAgIC8vcmVzZXR0aW5nIHRoZSBnYW1lLlxuICAkcmVzZXRCdXR0b24ub24oJ2NsaWNrJywgKCk9PntcbiAgICByZXNldCgpO1xuICB9KTtcblxuICAkKCdkaXYucGllY2UnKS5vbignY2xpY2snLChldmVudCk9PntcbiAgICAvL3R1cm4gYHRoaXNgIGludG8gYSBqUXVlcnkgb2JqZWN0XG4gICAgY29uc3QgJHRoaXNQaWVjZSA9ICQoZXZlbnQudGFyZ2V0KTtcbiAgICAvL1RFU1QuIGNoZWNraW5nIHRoZSBwaWVjZSBpbmRleC5cbiAgICBjdXJyZW50UG9zaXRpb24oKTsgLy9yZXByZXNlbnRzIHggYW5kIHkgY29vcmRzXG4gICAgbGV0IGluZGV4ID0gY29vcmRzO1xuICAgIC8vZ2V0dGluZyB0aGUgbG9jYXRpb24gb2YgdGhlIHBpZWNlXG4gICAgY29uc29sZS5sb2coaW5kZXgpO1xuICAgIGNvbnN0IGZpcnN0Q29sdW1uID0gaW5kZXggKyB3aWR0aCArIDE7XG4gICAgY29uc29sZS5sb2coZmlyc3RDb2x1bW4pO1xuICAgIGNvbnN0IGRhcmtQaWVjZSA9ICR0aGlzUGllY2UuaGFzQ2xhc3MoJ2RhcmsnKTtcbiAgICBjb25zb2xlLmxvZyhkYXJrUGllY2UpO1xuXG4gICAgLy8gaWYgKGluZGV4ICUgd2lkdGggPT09IDAgJiYgJGRhcmtQaWVjZSl7XG4gICAgLy8gICBpbmRleCArIHdpZHRoICsgMVxuICAgIC8vIH1cbiAgICAvLyB0YWtlIHRoZSBpbmRleCB4IGFuZCB5IHZhbHVlIGFzIGluZGV4IGFuZCBjaGVja1xuICAgIC8vaWYgaW5kZXggJSB3aWR0aCA9PT0gMCB0aGUgZmlyc3QgY29sdW1uIG9yXG4gICAgLy9pZiBpbmRleCAlIHdpZHRoID09PSB3aWR0aC0xIHRoZSBsYXN0IGNvbHVtblxuICAgIC8vaWYgZmlyc3QgY29sdW1uIGlzIHRydWUgdGhlbiBjaGVjayBjb2xvci9wMSBvciBwMlxuICAgIC8vcDFcbiAgICAvL2lmIHAxIGNoZWNrIHNxdWFyZSBkaWFnb25hbGx5IGxlZnQgaWYgZW1wdHkgdXNpbmdcbiAgICAvL2luZGV4ICsgd2lkdGggKyAxIGFkZCB0aGUgY2xhc3MgJ21vdmFibGUnXG4gICAgLy9pZiBsYXN0IGNvbHVtbiBpcyB0cnVlIHRoZW4gY2hlY2sgY29sb3IvcDEgb3IgcDJcbiAgICAvL2lmIHAxIGNoZWNrIHNxdWFyZSBkaWFnb25hbGx5IHJpZ2h0IGlmIGVtcHR5IHVzaW5nXG4gICAgLy9pbmRleCArIHdpZHRoLTEgYWRkIHRoZSBjbGFzcyAnbW92YWJsZSdcbiAgICAvL3VzZSBDU1MgdG8gaGlnaGxpZ2h0IHRoZSBtb3ZhYmxlIHNxdWF1cmVzIChsZWdhbCBtb3ZlcylcbiAgICAvL3AyXG4gICAgLy9lbHNlIGl0J3MgcDJcblxuXG5cblxuXG5cbiAgICAvL3RvZ2dsaW5nIHRoZSAnc2VsZWN0ZWQnIGNsYXNzIG9mIHRoaXMgcGllY2VcbiAgICAvL2FuZCBwb3NzaWJsZSBkZXNlbGVjdGluZyBvdGhlciBwaWVjZXNcbiAgICB0b2dnbGVTZWxlY3QoJHRoaXNQaWVjZSk7XG5cbiAgfSk7XG5cbiAgLy9jaGVja3MgdGhlIGN1cnJlbnRQb3NpdGlvbiBvZiB0aGUgY2xpY2tlZCBvciBzZWxlY3RlZCBkaXYgYW5kIHJldHVybnMgdGhlIGNvb3Jkcy5cbiAgZnVuY3Rpb24gY3VycmVudFBvc2l0aW9uKCl7XG4gICAgY29uc3QgcG9zaXRpb24gPSAkKGV2ZW50LnRhcmdldCkucG9zaXRpb24oKTtcbiAgICBjb29yZHMgPSBnZXRDb29yZHMocG9zaXRpb24udG9wLHBvc2l0aW9uLmxlZnQpO1xuICAgIC8vIGNvbnNvbGUubG9nKGNvb3Jkcyk7Ly9nZXR0aW5nIHRoZSBsb2NhdGlvbiBvZiB0aGUgcGllY2VcbiAgICByZXR1cm4gY29vcmRzO1xuXG4gIH1cblxuICAkKCdkaXYuc3F1YXJlJykub24oJ2NsaWNrJywgKGUpPT57XG4gICAgY3VycmVudFBvc2l0aW9uKCk7Ly90aGUgY3VycmVudFBvc2l0aW9uIG9mIHRoZSBzcXVhcmU7IGNvb3Jkc1xuICAgIC8vIGNvbnNvbGUubG9nKCdjb29yZHMnLCBjb29yZHMpO1xuICAgIC8vdHVybiBgZSBvciBldmVudGAgaW50byBhIGpRdWVyeSBvYmplY3RcbiAgICBjb25zdCAkcGllY2VUb01vdmUgPSAkKGUudGFyZ2V0KTtcblxuXG4gICAgLy9pZiAkdGhpcyBpcyBhIGxlZ2FsIHNxdWFyZSB0byBtb3ZlIHRvLi4uXG4gICAgaWYgKCRwaWVjZVRvTW92ZS5oYXNDbGFzcygnbW92YWJsZScpKSB7XG5cbiAgICAgICAgICAvL2dldCB0aGUgcGllY2Ugd2l0aCB0aGUgY2xhc3MgJ3NlbGVjdGVkJ1xuICAgICAgY29uc3QgJHNlbGVjdGVkUGllY2UgPSAkKCdkaXYucGllY2Uuc2VsZWN0ZWQnKTtcblxuICAgICAgICAgIC8vb25seSBtb3ZlIGlmIHRoZXJlIGlzIGV4YWN0bHkgb25lIHNlbGVjdGVkIHBpZWNlXG4gICAgICBpZiAoJHNlbGVjdGVkUGllY2UubGVuZ3RoID09PSAxKSB7XG4gICAgICAgICAgICAvL2dldCB0aGUgaW5kZXggb2YgdGhlIHNxdWFyZVxuICAgICAgICAgICAgLy9hbmQgdHJhbnNsYXRlIGl0IHRvIHBpeGVsIHBvc2l0aW9uXG4gICAgICAgIGNvbnN0IGluZGV4ID0gJHBpZWNlVG9Nb3ZlLnByZXZBbGwoKS5sZW5ndGg7XG4gICAgICAgIGNvbnN0IHggPSBpbmRleCAlIDg7XG4gICAgICAgIGNvbnN0IHkgPSBNYXRoLmZsb29yKGluZGV4IC8gOCk7XG4gICAgICAgIGNvbnN0IHBpeGVscyA9IGdldFBpeGVscyh4LHkpO1xuICAgICAgICAgICAgLy9hY3R1YWxseSBkbyB0aGUgbW92aW5nXG4gICAgICAgIG1vdmVQaWVjZVRvKCRzZWxlY3RlZFBpZWNlLHBpeGVscy50b3AscGl4ZWxzLmxlZnQpO1xuICAgICAgICAgICAgLy9pbmNyZW1lbnQgdGhlIG1vdmUgY291bnRlclxuICAgICAgICBpbmNyZW1lbnRtb3ZlQ291bnRlcigpO1xuICAgICAgICAgICAgLy91bi1zZWxlY3QgdGhlIHBpZWNlXG4gICAgICAgICRzZWxlY3RlZFBpZWNlLnJlbW92ZUNsYXNzKCdzZWxlY3RlZCcpO1xuXG4gICAgICAgICAgICAvL3NldCB0aGUgbmV3IGxlZ2FsIG1vdmVzXG4gICAgICAgICQoJ2Rpdi5zcXVhcmUnKS5yZW1vdmVDbGFzcygnbW92YWJsZScpO1xuICAgICAgICBnZXRNb3ZhYmxlU3F1YXJlcygpLmFkZENsYXNzKCdtb3ZhYmxlJyk7XG4gICAgICB9XG5cbiAgICB9XG5cbiAgfSk7XG5cblxuICAvLyBNT1JFIEZVTkNUSU9OU1xuXG5cbiAgLy9mdW5jdGlvbiBmb3IgdHJhbnNsYXRpbmcgYW4geCx5IGNvb3JkaW5hdGVzIHRvIGEgcGl4ZWwgcG9zaXRpb25cbiAgLy90aGUgY29udmVudGlvbiBpcyB0aGF0IHRoZSBzcXVhcmUgaW4gdGhlIHVwcGVyIGxlZnQgY29ybmVyIGlzIGF0IHBvc2l0aW9uIDAsMFxuICAvL3RoZSBzcXVhcmUgaW4gdGhlIHVwcGVyIHJpZ2h0LCBhdCA3LDAgYW5kIHRoZSBsb3dlclxuICAvL3JpZ2h0IGF0IDcsN1xuICBmdW5jdGlvbiBnZXRQaXhlbHMoeCx5KSB7XG4gICAgICAvL3Rha2VzIGFuIHgseSBwb3NpdGlvbiwgcmV0dXJuc1xuICAgICAgLy9waXhlbHMgZnJvbSB0aGUgbGVmdCwgcmlnaHRcbiAgICByZXR1cm4ge1xuICAgICAgJ3RvcCc6ICh5ICogKHdpZHRoK2JvcmRlcikpKydweCcsXG4gICAgICAnbGVmdCc6ICh4ICogKHdpZHRoK2JvcmRlcikpKydweCdcbiAgICB9O1xuICB9XG5cbiAgLy9mdW5jdGlvbiBmb3IgdHVybmluZyBhIHBpeGVsIHBvc2l0aW9uXG4gIC8vaW50byB0aGUgeCx5IGNvb3JkaW5hdGUgb2YgYSBzcXVhcmUgb24gdGhlIGJvYXJkXG4gIC8vaXQgZm9sbG93cyB0aGUgc2FtZSBjb29yZGluYXRlIGNvbnZlbnRpb24gYXMgZ2V0UGl4ZWxzXG4gIGZ1bmN0aW9uIGdldENvb3Jkcyh0b3AsbGVmdCkge1xuICAgICAgLy9yZXR1cm5zIGFuIHggYW5kIGEgeVxuICAgICAgLy9naXZlbiBhIHRvcCBhbmQgbGVmdCBwaXhlbHNcbiAgICByZXR1cm4ge1xuICAgICAgJ3gnOiBsZWZ0IC8gKHdpZHRoICsgYm9yZGVyKSxcbiAgICAgICd5JzogdG9wIC8gKHdpZHRoICsgYm9yZGVyKVxuICAgIH07XG4gIH1cblxuICAvL3V0aWxpdHkgZnVuY3Rpb24gZm9yIHJldHVybmluZ1xuICAvL3RoZSBzZXQgb2YgdW5vY2N1cGllZCBkYXJrIHNxdWFyZXNcbiAgLy8ocG9zc2libGUgcGxhY2VzIHRvIG1vdmUgYSBwaWVjZSlcbiAgZnVuY3Rpb24gZ2V0TW92YWJsZVNxdWFyZXMoKSB7XG4gICAgICAvL3NlbGVjdCBhbGwgb2YgdGhlIHNxdWFyZXNcbiAgICBjb25zdCAkc3F1YXJlcyA9ICQoJ2Rpdi5zcXVhcmUnKTtcblxuICAvL3NlbGVjdCB0aGUgb2NjdXBpZWQgb25lcyB1c2luZyB0aGUgalF1ZXJ5IG1hcCgpIG1ldGhvZFxuICAvL21hcCBjcmVhdGVzIGEgbmV3IG9iamVjdCBmcm9tIGFuIGV4aXN0aW5nIG9uZSB1c2luZyBhIHRyYW5zbGF0aW9uIGZ1bmN0aW9uXG4gICAgY29uc3QgJHRha2VuU3F1YXJlcyA9XG4gICAgICAgICAgJCgnZGl2LnBpZWNlJykubWFwKGZ1bmN0aW9uKGluZGV4LHBpZWNlKSB7XG4gICAgICAgICAgICAvL3RoaXMgZnVuY3Rpb24gdHJhbnNsYXRlcyBhIHBpZWNlXG4gICAgICAgICAgICBjb25zdCBwb3NpdGlvbiA9ICQocGllY2UpLnBvc2l0aW9uKCk7XG4gICAgICAgICAgICBjb25zdCBjb29yZHMgPSBnZXRDb29yZHMocG9zaXRpb24udG9wLHBvc2l0aW9uLmxlZnQpO1xuICAgICAgICAgICAgY29uc3Qgc3F1YXJlSW5kZXggPSBjb29yZHMueSAqIDggKyBjb29yZHMueDtcbiAgICAgICAgICAgIHJldHVybiAkc3F1YXJlc1tzcXVhcmVJbmRleF07XG4gICAgICAgICAgfSk7XG5cbiAgICBjb25zdCAkb3V0ID0gJCgnZGl2LnNxdWFyZS5kYXJrJykubm90KCR0YWtlblNxdWFyZXMpO1xuICAgIHJldHVybiAkb3V0O1xuICB9XG5cbiAgZnVuY3Rpb24gc2V0VXBQaWVjZXMoKSB7XG4gICAgICAvL3NlbGVjdCBhbGwgdGhlIGRpdnMgd2l0aCBjbGFzcyAncGllY2UnXG4gICAgJCgncGllY2UnKTtcbi8vYWRkIHRoZSAnbGlnaHQnIGNsYXNzIHRvIGhhbGYgb2YgdGhlbVxuICAgICQoJ2Rpdi5waWVjZTpldmVuJykuYWRkQ2xhc3MoJ2xpZ2h0Jyk7XG4vL2pRdWVyeSdzIGV2ZW4gYW5kIG9kZCBzZWxlY3RvciBtZXRob2RzIHRvIGFzc2lnbiB0aGUgY2xhc3NlcyAubGlnaHQgYW5kIC5kYXJrLlxuLy9hZGQgdGhlICdkYXJrJyB0byB0aGUgb3RoZXIgaGFsZlxuICAgICQoJ2Rpdi5waWVjZTpvZGQnKS5hZGRDbGFzcygnZGFyaycpO1xuXG4gIH1cblxuICBmdW5jdGlvbiBtb3ZlUGllY2VUbygkcGllY2UsbmV3VG9wLG5ld0xlZnQpIHtcbiAgICAgIC8vc2V0IHRoZSBjc3MgJ3RvcCcgYW5kICdsZWZ0J1xuICAgICAgLy9hdHRyaWJ1dGVzIG9mIHRoZSBwYXNzZWQgcGllY2VcbiAgICAgIC8vdG8gdGhlIGFyZ3VtZW50cyBuZXdUb3AgYW5kIG5ld0xlZnRcbiAgICAkcGllY2UuY3NzKCd0b3AnLCBuZXdUb3ApO1xuICAgICRwaWVjZS5jc3MoJ2xlZnQnLCBuZXdMZWZ0KTtcblxuICB9XG5cbiAgZnVuY3Rpb24gc2V0VXBCb2FyZCgpIHtcbiAgICAgIC8vaXRlcmF0ZSB0aHJvdWdoIGFsbCBvZiB0aGUgZGl2cyB3aXRoIGNsYXNzIGBzcXVhcmVgXG4gICAgICAvL2ZpZ3VyZSBvdXQgd2hldGhlciBlYWNoIG9uZSBzaG91bGQgYmVcbiAgICAgIC8vbGlnaHQgb3IgZGFyaywgYW5kIGFzc2lnbiB0aGUgcHJvcGVyIGNsYXNzXG4gICAgY29uc3QgJGVhY2hTcXVhcmUgPSAkKCdkaXYuc3F1YXJlJyk7XG4gICAgJGVhY2hTcXVhcmUuZWFjaChmdW5jdGlvbihpbmRleCl7XG4gICAgICBpZihsaWdodE9yRGFyayhpbmRleCk9PT0gMCl7XG4gICAgICAgICQodGhpcykuYWRkQ2xhc3MoJ2xpZ2h0Jyk7XG4gICAgICB9ZWxzZXtcbiAgICAgICAgJCh0aGlzKS5hZGRDbGFzcygnZGFyaycpO1xuICAgICAgfVxuICAgIH0pO1xuICAgICAgLy9pbm5lciBoZWxwZXIgZnVuY3Rpb24gdGhhdCB0YWtlcyBhIG51bWJlciBiZXR3ZWVuXG4gICAgICAvLzAgYW5kIDYzIChpbmNsdXNpdmUpIGFuZCByZXR1cm5zIDEgaWYgdGhlIHNxdWFyZSBzaG91bGQgYmVcbiAgICAgIC8vZGFyaywgYW5kIDAgaWYgdGhlIHNxdWFyZSBzaG91bGQgYmUgbGlnaHRcbiAgICBmdW5jdGlvbiBsaWdodE9yRGFyayhpbmRleCkge1xuICAgICAgY29uc3QgeCA9IGluZGV4ICUgODtcbiAgICAgIGNvbnN0IHkgPSBNYXRoLmZsb29yKGluZGV4IC8gOCk7XG4gICAgICBjb25zdCBvZGRYID0geCAlIDI7XG4gICAgICBjb25zdCBvZGRZID0geSAlIDI7XG4gICAgICByZXR1cm4gKG9kZFggXiBvZGRZKTtcbiAgICB9XG5cbiAgfVxuXG4gIGZ1bmN0aW9uIHRvZ2dsZVNlbGVjdCgkcGllY2UpIHtcbiAgICAgIC8vaWYgJHBpZWNlIGhhcyB0aGUgY2xhc3MgJ3NlbGVjdGVkJyxyZW1vdmUgaXRcbiAgICAgIC8vaWYgJHBpZWNlIGRvZXMgbm90IGhhdmUgdGhlIGNsYXNzICdzZWxlY3RlZCdcbiAgICAgIC8vbWFrZSBzdXJlIG5vIG90aGVyIGRpdnMgd2l0aCB0aGUgY2xhc3MgJ3BpZWNlJ1xuICAgICAgLy9oYXZlIHRoYXQgY2xhc3MsIHRoZW4gc2V0ICRwaWVjZSB0byBoYXZlIHRoZSBjbGFzc1xuICAgIGlmKCRwaWVjZS5oYXNDbGFzcygnc2VsZWN0ZWQnKSlcbiAgICAgICRwaWVjZS5yZW1vdmVDbGFzcygnc2VsZWN0ZWQnKTtcbiAgICBlbHNlIHtcbiAgICAgICQoJ2Rpdi5waWVjZScpLmVhY2goZnVuY3Rpb24oaW5kZXgscGllY2UpIHtcbiAgICAgICAgaWYoJChwaWVjZSkuaGFzQ2xhc3MoJ3NlbGVjdGVkJykpXG4gICAgICAgICAgJChwaWVjZSkucmVtb3ZlQ2xhc3MoJ3NlbGVjdGVkJyk7XG4gICAgICB9KTtcbiAgICAgICRwaWVjZS5hZGRDbGFzcygnc2VsZWN0ZWQnKTtcbiAgICB9XG5cbiAgfS8vZW5kIG9mIHRvZ2dsZVNlbGVjdCBmdW5jdGlvblxuXG4gIGZ1bmN0aW9uIGluY3JlbWVudG1vdmVDb3VudGVyKCkge1xuICAgICAgLy9nZXRzIHRoZSBodG1sIG9mIHRoZSBzcGFuIHdpdGggaWQgbW92ZUNvdW50ZXJcbiAgICAgIC8vdHVybnMgaXQgaW50byBhIG51bWJlclxuICAgICAgLy9pbmNyZW1lbnRzIGl0IGJ5IG9uZVxuICAgICAgLy9zZXRzIHRoZSBodG1sIG9mIHRoZSBzcGFuIHdpdGggaWQgbW92ZUNvdW50ZXJcbiAgICAgIC8vdG8gdGhlIG5ldyBtb3ZlIGNvdW50XG4gICAgJCgnI21vdmVDb3VudGVyJykuaHRtbChwYXJzZUludCgkKCcjbW92ZUNvdW50ZXInKS5odG1sKCksMTApKzEpO1xuICB9XG5cbiAgLy90aGlzIHJlc2V0cyB0aGUgZ2FtZSBieSBlZmZlY3RpdmVseSByZWxvYWRpbmcgdGhlIHBhZ2UgZnJvbSBjYWNoZVxuICBmdW5jdGlvbiByZXNldCgpe1xuICAgIGxvY2F0aW9uLnJlbG9hZCgpO1xuICB9XG5cblxuXG5cbn0pOy8vZW5kIG9mIEpTIGxvYWRcblxuXG4vKlxuVE9ETzpcbjEuIFBsYXllciBjaGFuZ2UgZnJvbSBwbGF5ZXIgMSB0byBwbGF5ZXIgMlxuMi4gRmlndXJlIG91dCBob3cgdG8gc3RvcCBpbGxlZ2FsIG1vdmVzLlxuICAtb25seSBtYWtlIHR3byBwb3N0aXRpb25zIGF2YWlsYWJsZSBhdCBhbnkgZ2l2ZW4gdGltZVxuICAtb25jZSB0aGUgcGllY2UgaGFzIG1vdmVkIGludG8gYSBwb3NpdGlvbiBtYWtlXG5cbiAgLU9uIGNsaWNrIG9mIHNxYXVyZVxuICAtZ2V0IHBpZWNlIG9uIHNxYXVyZSAoZS50YXJnZXQpXG4gIC1jaGVjayBpZiBwaWVjZSBiZWxvbmdzIHRvIHAxIG9yIHAyXG4gIC1jaGVjayByZWxldmFudCBzcXVhcmVzXG4gICAgLmlmIGluZGV4IG9mIGN1cnJlbnRTcXVhcmVcbiAgICAuaWYgc3F1YXJlIGlzIG5vdCBpbiB0aGUgZmlyc3QgY29sdW1uXG4gICAgY2hlY2sgc3F1YXJlIGRpYWdvbmFsbHkgbGVmdCBhbmQgbW92YWJsZSBjbGFzcyBpZiBlbXB0eVxuICAgIC5pZiBzcXVhcmUgaXMgbm90IGluIHRoZSBsYXN0IGNvbHVtblxuICAgIGNoZWNrIHNxdWFyZSBkaWFnb25hbGx5IHJpZ2h0IGFuZCBtb3ZhYmxlIGNsYXNzIGlmIGVtcHR5XG4gIC1vbmNlIHBpZWNlIGlzIG1vdmVkIG9yIGlmIHVuLXNlbGVjdGVkIHJlbW92ZSBtb3ZhYmxlIGNsYXNzIGZyb20gYWxsIHNxdWFyZXMuXG5cbmluZGV4IChwb3NpdGlvbiklIHdpZHRoID09PSAwIC4uLnJlcHJlc2VudHMgdGhlIGZpcnN0IGNvbHVtblxuaW5kZXggJSB3aWR0aCA9PT0gd2lkdGgtMSAuLi5yZXByZXNlbnRzIHRoZSBsYXN0IGNvbHVtblxuXG5pbmRleCArIHdpZHRoLTEgZm9yIHBsYXllcjEgaXMgZ29pbmcgbGVmdCBkaWFnb25hbGx5XG5pbmRleCArIHdpZHRoLTEgZm9yIHBsYXllcjEgaXMgZ29pbmcgcmlnaHQgZGlhZ29uYWxseVxuXG5pbmRleCAtIHdpZHRoKzEgZm9yIHBsYXllcjIgaXMgZ29pbmcgbGVmdCBkaWFnb25hbGx5XG5pbmRleCAtIHdpZHRoLTEgZm9yIHBsYXllcjIgaXMgZ29pbmcgcmlnaHQgZGlhZ29uYWxseVxuXG5cbjMuIEp1bXAgbW92ZXMgdG8gbWFrZSB0aGUgb3Bwb25lbnRzIHBpZWNlIGRpc2FwcGVhciBmcm9tIHRoZSBib2FyZCBhbmQgcmVzZXRcbiAgdGhlIHBvc2l0b25cbjQuIEtpbmcgbWFrZXIgZnVuY3Rpb25cbjUuIEhvdyB0byB0YWtlIGluIHRoZSB0b3AgcmlnaHQgcG9zaXRpb25cbjYuUmVzZXQgdGhlIGdhbWUgYmV0dGVyXG5cblxuKi9cbiJdfQ==
